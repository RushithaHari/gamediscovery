# ==============================================================================
# IMPORTS
# ==============================================================================
use strict;
use warnings;
require "../_shared/functions.pl";

# ==============================================================================
# MAIN LOOP
# ==============================================================================
while(<>){
    # split parts
    (my $source, my $type, my $target) = split(" ", $_, 3);

    # ==========================================================================
    # SOURCE
    # ==========================================================================
    (my $capture) = $source =~ /.*resource\/(.+)>/;
    if(!$capture){
        next
    }
    my $sourceId = id($capture);

    # ==========================================================================
    # TYPE
    # ==========================================================================
    ($capture) = $type =~ /.*property\/(.+)>/;
    if(!$capture){
        next
    }
    my $typeId = id($capture);

    # ==========================================================================
    # TARGET
    # ==========================================================================
    my $targetId;

    # parse target (entity)
    ($capture) = $target =~ /.*resource\/(.+)>/;
    if($capture){
        $targetId = id($capture)
    }

    # parse target (label)
    if(!$capture){
        ($capture) = $target =~ /\"(.+)\"\@en/;
        if($capture){
            $targetId = $capture;
        }
    }

    # parse target (number)
    if(!$capture){
        ($capture) = $target =~ /\"(.+)\"\^\^/;
        if($capture){
            $targetId = $capture;
        }
    }

    # target not found
    if(!$capture){
       next;
    }

    # ==========================================================================
    # OUTPUT
    # ==========================================================================
    print "$sourceId\t$typeId\t$targetId\n";
}
